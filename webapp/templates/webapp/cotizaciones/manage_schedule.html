{% extends 'webapp/base.html' %}
{% load static %}
{% block title %}Configurar frecuencia de envío{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'webapp/css/cotizaciones/modify_quote.css' %}">
{% endblock %}

{% block content %}
<div class="modify-quote-container">
    <div class="main-content">
        <!-- Header -->
        <div class="modify-quote-header">
            <div class="header-content">
                <a href="{% url 'landing' %}" class="back-button">← Volver al inicio</a>
                <div class="header-text">
                    <h1 class="modify-quote-title">Configuración de Envío</h1>
                    <p class="modify-quote-subtitle">Ajusta la frecuencia de los correos automáticos</p>
                </div>
            </div>
        </div>

        <!-- Main Section -->
        <div class="modify-section">
            <h2 class="section-title">Frecuencia y Horario</h2>

            <div class="modify-content">
                <div class="form-container">
                    <form method="post" class="modify-form">
                        {% csrf_token %}

                        <!-- Frecuencia -->
                        <div class="form-row single-field-row">
                            <div class="form-field">
                                <label class="field-label">Frecuencia:</label>
                                <select name="frequency" class="form-input" id="frequency-select">
                                    <option value="daily" {% if config.frequency == "daily" %}selected{% endif %}>Diario</option>
                                    <option value="weekly" {% if config.frequency == "weekly" %}selected{% endif %}>Semanal</option>
                                    <option value="custom" {% if config.frequency == "custom" %}selected{% endif %}>Personalizado</option>
                                </select>
                            </div>
                        </div>

                        <!-- Día de la semana (solo semanal) -->
                        <div class="form-row single-field-row" id="weekly-settings" {% if config.frequency != "weekly" %}style="display:none"{% endif %}>
                            <div class="form-field">
                                <label class="field-label">Día de la semana:</label>
                                <select name="weekday" class="form-input">
                                    <option value="monday" {% if config.weekday == "monday" %}selected{% endif %}>Lunes</option>
                                    <option value="tuesday" {% if config.weekday == "tuesday" %}selected{% endif %}>Martes</option>
                                    <option value="wednesday" {% if config.weekday == "wednesday" %}selected{% endif %}>Miércoles</option>
                                    <option value="thursday" {% if config.weekday == "thursday" %}selected{% endif %}>Jueves</option>
                                    <option value="friday" {% if config.weekday == "friday" %}selected{% endif %}>Viernes</option>
                                    <option value="saturday" {% if config.weekday == "saturday" %}selected{% endif %}>Sábado</option>
                                    <option value="sunday" {% if config.weekday == "sunday" %}selected{% endif %}>Domingo</option>
                                </select>
                            </div>
                        </div>

                        <!-- Hora y Minuto -->
                        <div class="form-row">
                            <div class="form-field">
                                <label class="field-label">Hora:</label>
                                <input type="number" name="hour" value="{{ config.hour }}" min="0" max="23" class="form-input">
                            </div>
                            <div class="form-field">
                                <label class="field-label">Minuto:</label>
                                <input type="number" name="minute" value="{{ config.minute }}" min="0" max="59" class="form-input">
                            </div>
                        </div>

                        <!-- Intervalo (solo personalizado) -->
                        <div class="form-row single-field-row" id="custom-settings" {% if config.frequency != "custom" %}style="display:none"{% endif %}>
                            <div class="form-field">
                                <label class="field-label">Intervalo (minutos):</label>
                                <input type="number" name="interval_minutes" value="{{ config.interval_minutes }}" class="form-input">
                            </div>
                        </div>

                        <!-- Botones -->
                        <div class="action-buttons">
                            <button type="submit" class="save-button">Guardar</button>
                            <a href="{% url 'landing' %}" class="discard-button">Cancelar</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById("frequency-select").addEventListener("change", function() {
    const value = this.value;
    document.getElementById("custom-settings").style.display = value === "custom" ? "flex" : "none";
    document.getElementById("weekly-settings").style.display = value === "weekly" ? "flex" : "none";
});
</script>
{% endblock %}
